<div class="p-grid mt-2" *ngIf="isModify!=null">
    <div class="xl:col-8 xl:col-offset-2 col-12">
        <p-card>
            <div class="p-grid">
                <i class="pi pi-times" style="float:right; font-size: 20px;" (click)="isModify=null"></i>
                <form class="col-8 col-offset-2" [formGroup]="TicketForm">

                    <h3 class="text-center">Modification d'un ticket</h3>
                    <div class="grid">
                        <div class="field col mt-2 mb-2 col-lg-6 col-6">
                            <label style="font-weight: bold;">Service:</label>

                            <select formControlName="service" class="form-control col-12"
                                (change)="changeServiceDropDown($event)">
                                <option [ngValue]="null" disabled>Choissisez un service</option>
                                <option *ngFor="let service of listServices" [ngValue]="service">
                                    {{ service.label }}
                                </option>
                            </select>
                        </div>
                        <div class="field col mt-2 mb-2 col-lg-6 col-6">
                            <label style="font-weight: bold;">Sujet:</label>
                            <select [disabled]="!TicketForm.value.service" formControlName="sujet"
                                class="form-control col-12">
                                <option [ngValue]="null" disabled>Choissisez un sujet</option>
                                <option *ngFor="let sujet of listSujetSelected[TicketForm.value.service._id]"
                                    [ngValue]="sujet">{{ sujet.label }}</option>
                            </select>
                        </div>
                        <div class="col-offset-5 md:col-offset-5 sm:col-offset-4">
                            <button pButton class="ui-button-raised ui-button-success" [disabled]="TicketForm.invalid"
                                label="Enregistrer" (click)="modifyTicket()"></button>
                        </div>
                    </div>
                </form>
            </div>
        </p-card>
    </div>
</div>
<div class="p-grid mt-2" *ngIf="showFormAddComment">
    <div class="xl:col-8 xl:col-offset-2 col-12">
        <p-card>
            <div class="p-grid">
                <i class="pi pi-times" style="float:right; font-size: 20px;" (click)="toggleFormCancel()"> </i>
                <form class="col-10 col-offset-1" [formGroup]="commentForm" enctype="multipart/form-data">
                    <h3 class="text-center" style="color: #3da827; font-weight: bold;">Envoyer un message</h3>
                    <div class="text-center">
                        <textarea formControlName="description" rows="5" cols="100" pInputTextarea
                            autoResize="autoResize" placeholder="Saisir un message"></textarea>
                    </div><br>
                    <div class="mt-2 col-8 col-offset-1" style="display: flex;">
                        <div class="col-8 mt-6">
                            <p-fileUpload #fubauto (uploadHandler)="onFileChange($event)" mode="basic"
                                chooseLabel="Joindre un fichier" customUpload="true" fileLimit="1"
                                accept=".docx,.pdf,.doc,.jpg,.png,.jpeg" maxFileSize="20000000" [auto]="true">
                            </p-fileUpload>
                        </div>
                        <label
                            style="font-weight: bold; text-decoration: underline; position: relative; left: 50%;">Statut
                            du ticket : </label>
                        <div class="field col col-1 mt-4" style=" position: relative; left: 20%;">
                            <p-dropdown formControlName="statut" [options]="statutList" optionLabel="value">
                            </p-dropdown>
                        </div>

                    </div>
                    <div class="col-4 col-offset-1">
                        <p *ngIf="commentForm.value.file">{{commentForm.value.file.filename | slice:0:15}}</p>
                    </div>


                    <div *ngIf="value.invalid">
                        <span class="error" *ngIf="value.errors?.maxlength">*Le fichier est trop volumineux (20MB
                            max).</span>
                    </div><br>
                    <div class="text-center">
                        <button [disabled]="commentForm.invalid || loading" pButton
                            class="ui-button-raised ui-button-success" label="Envoyer" (click)="SendComment()"></button>
                    </div>
                </form>
            </div>
        </p-card>
    </div>
</div>
<div class="p-grid mt-2" *ngIf="showRevert!=null">
    <div class="xl:col-8 xl:col-offset-2 col-12">
        <p-card>
            <div class="p-grid">
                <i class="pi pi-times" style="float:right; font-size: 20px;" (click)="showRevert=null"> </i>
                <form class="col-10 col-offset-1" [formGroup]="RevertForm" enctype="multipart/form-data">
                    <h3 class="text-center" style="color: #3da827; font-weight: bold;">Renvoyer un ticket à la queue
                        d'entrée</h3><br>
                    <div class="text-center">
                        <label style="font-weight: bold; ; text-decoration: underline;">Justificatif :
                        </label>
                    </div>
                    <div class="text-center"><br>
                        <textarea formControlName="justificatif" rows="5" cols="100" pInputTextarea
                            autoResize="autoResize" placeholder="Saisir un message"
                            placeholder="Expliquer la raison de votre renvoie"></textarea>
                    </div><br>
                    <div class="text-center">
                        <button class="col-offset-5 xl:col-offset-5 sm:col-offset-4" [disabled]="RevertForm.invalid"
                            pButton class="ui-button-raised ui-button-success" label="Envoyer"
                            (click)="revert()"></button>
                    </div>
                </form>
            </div>
        </p-card>
    </div>
</div>
<div *ngIf="showFormAdd">
    <div class="p-grid mt-2">
        <div class="xl:col-8 xl:col-offset-2 col-12">
            <p-card>
                <div class="p-grid">
                    <i class="pi pi-times" style="float:right; font-size: 20px;" (click)="showFormAdd=false"> </i>

                    <form class="col-8 col-offset-2" [formGroup]="TicketFormAdd">
                      
                        <h3 class="text-center">Création d'un ticket</h3>

                        <div class="grid">
                            <div class="field col mt-2 mb-2 col-lg-6 col-6">
                                <label style=" font-weight: bold;">Service:</label>
                                <select formControlName="service" class="form-control col-12" (change)="onChangeAdd()">
                                    <option [ngValue]="null" disabled>Choissisez un service</option>
                                    <option *ngFor="let service of listServices" [ngValue]="service">
                                        {{ service.label }}
                                    </option>
                                </select>
                            </div>
                            <div class="field col mt-2 mb-2 col-lg-6 col-6">
                                <label style="font-weight: bold;">Sujet:</label>
                               
                                <select [disabled]="selectedService" formControlName="sujet"
                                    class="form-control col-12">
                                    <option *ngIf="TicketFormAdd.value.service" [ngValue]="null" disabled>Choissisez un sujet
                                    </option>
                                    <option *ngFor="let sujet of listSujetSelected[TicketFormAdd.value.service._id]"
                                        [ngValue]="sujet">
                                        {{ sujet.label }}
                                    </option>
                                </select>
                            </div>
                            <div class="field col mt-2 mb-2 col-lg-12 col-12">
                                <label style="font-weight: bold;">Description:</label>
                                <textarea type="text" formControlName="description" class="form-control col-12"
                                    placeholder="Description" pInputTextarea></textarea>
                            </div>
                            <div class="field col mt-2 mb-2 col-lg-12 col-12">
                                <label style="font-weight: bold;">Email de l'utilisateur:</label>
                                <input type="email" formControlName="email" class="form-control col-12"
                                placeholder="Email de l'utilisateur" pInputText>
                                <div *ngIf="(email.invalid) && (email.touched || email.dirty)">
                                    <span class="error" *ngIf="email.errors?.required">*L'adresse mail est
                                        obligatoire.</span>
                                    <span class="error" *ngIf="email.errors?.pattern && email.value.endsWith('@estya.com')">*L'email n'est pas correct.</span>
                                    <span class="error" *ngIf="email.errors?.pattern && !email.value.endsWith('@estya.com')">*L'email doit être un mail estya.com.</span>
                                </div>
                            </div>
                            <div class="col-offset-5 md:col-offset-5 sm:col-offset-4">
                                <button pButton class="ui-button-raised ui-button-success"
                                    [disabled]="TicketFormAdd.invalid" label="Enregistrer" (click)="addTicket();showFormAdd=false"></button>
                            </div>
                        </div>
                    </form>
                </div>
            </p-card>
        </div>
    </div>
</div>
<div class="grid">
    <div class="col-10 col-offset-1">
        <button *ngIf="!showFormAdd" pButton type="button" label="Ajouter" style="float:right;"
            (click)="toggleFormAdd()"></button>
        <h3>Queue d'entrée</h3>
        <div class="col-12 card shadow-lg my-5">
            <p-table #dt1 *ngIf="queueList" [columns]="cols" [value]="queueList" dataKey="_id" [rows]="4"
                [paginator]="true" [pageLinks]="5" [responsive]="true" rowExpandMode="single"
                (sortFunction)="customSort($event)" [customSort]="true" [globalFilterFields]="['customid','description']">
                <ng-template pTemplate="caption">
                    <div class="p-d-flex">
                        <div style="display: flex;">
                            <p-dropdown *ngIf="token['role']=='Admin'" placeholder="Choissisez un service" filter="true"
                                [options]="dropdownService"
                                (onChange)="dt1.filter($event.value, 'service_id', 'equals')"></p-dropdown>
                            <span style="margin-left:2%;">
                                <p-dropdown placeholder="Choissisez un sujet" filter="true" [options]="showSujetQ"
                                    (onChange)="dt1.filter($event.value, 'sujet_id', 'equals')"></p-dropdown>
                            </span>
                            <input style="margin-left:2%;" pInputText type="text" (input)="dt1.filterGlobal($event.target.value, 'contains')" placeholder="Recherche" />
                        </div>
                        
                    </div>
                </ng-template>
                <ng-template pTemplate="header" let-columns>
                    <tr>
                        <th style="width: 3rem"> </th>

                        <th style="text-decoration: underline; padding-top: 5%;" pSortableColumn="service"> Service
                            <p-sortIcon field="service"></p-sortIcon>
                        </th>
                        <th style="text-decoration: underline; padding-top: 5%;" pSortableColumn="sujet"> Sujet
                            <p-sortIcon field="sujet"></p-sortIcon>
                        </th>
                        <th style="text-decoration: underline; padding-top: 5%;" pSortableColumn="date_ajout"> Date de
                            création <p-sortIcon field="date_ajout"></p-sortIcon>
                        </th>
                        <th style="text-decoration: underline; padding-top: 5%;"> Temps d'attente
                        </th>
                        <th style="text-decoration: underline;padding-top: 5%;">
                            Action
                        </th>
                    </tr>

                </ng-template>
                <ng-template pTemplate="body" let-rowData let-columns="columns" let-expanded="expanded">
                    <tr (onDragStart)="dragStart($event, rowData)" (onDragEnd)="dragEnd($event)"
                        *ngIf="sujetList[rowData.sujet_id]" pDraggable="QueueToAccAff">
                        <td>
                            <button type="button" pButton [pRowToggler]="rowData" class="expanded"
                                [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"></button>
                        </td>
                        <td>
                            {{serviceList[sujetList[rowData.sujet_id].service_id]}}
                        </td>
                        <td>
                            {{sujetList[rowData.sujet_id].label}}
                        </td>
                        <td>
                            {{rowData.date_ajout | date:'dd/MM/yyyy HH:mm'}}
                        </td>
                        <td>
                            {{showWaitingTime(rowData)}}
                        </td>
                        <td>
                            <i *ngIf="rowData.createur_id!=token.id" pTooltip="Accepter" tooltipPosition="bottom"
                                class="pi pi-check" (click)="QueueToAccAff(rowData)"></i>

                            <i pTooltip="Modifier" tooltipPosition="bottom" style="margin-left: 5%;"
                                class="pi pi-pencil" (click)="modify(rowData);showFormUpdate=true"></i>
                            <i pTooltip="Affecter" tooltipPosition="bottom" style="margin-left: 5%;"
                                *ngIf="isReponsable" class="pi pi-user-plus" (click)="showDropdownUser(rowData)"></i>
                            <p-dropdown *ngIf="showDropDown && showDropDown==rowData" [options]="userList"
                                (onChange)="Affected($event)" placeholder="Choissisez un agent">
                            </p-dropdown>
                        </td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="rowexpansion" let-rowData>
                    <tr style="text-align: left; margin-left: 2em; background-color:white;">
                        <td [attr.colspan]="6">
                            <p-fieldset legend="Informations du ticket"
                                [style]="{'color':'green','font-weight': 'bold'}">
                                <div class="p-grid ui-fluid" style="color: black;font-weight:normal;">
                                    <div class="ui-g-6 ui-md-6">
                                        <div class="ui-g-6 ui-md-6"><b style="text-align:left !important;">Statut:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                            {{rowData.statut}} </div>
                                    </div>
                                    <div class="ui-g-6 ui-md-6">
                                        <div class="ui-g-6 ui-md-6"><b
                                                style="text-align:left !important;">Description:</b> </div>
                                        <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                            {{rowData.description}}</div>
                                    </div>
                                    <div class="ui-g-12 ui-md-12">
                                        <div class="ui-g-6 ui-md-6"><b
                                                style="text-align:left !important;">Numéro:</b> </div>
                                        <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                            {{rowData.customid}}</div>
                                    </div>
                                </div>
                            </p-fieldset>
                            <p-fieldset legend="Créateur du ticket" [style]="{'color':'green','font-weight': 'bold'}">
                                <div class="p-grid ui-fluid" style="color: black;font-weight:normal">
                                    <div class="ui-g-12 ui-md-12">
                                        <div class="ui-g-12 ui-md-4">
                                            <div class="ui-g-6 ui-md-6"><b style="text-align:left !important;">Nom et
                                                    Prénom:</b> </div>
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                {{userDic[rowData.createur_id].firstname |
                                                titlecase }} {{userDic[rowData.createur_id].lastname | titlecase
                                                }}</div>
                                        </div>
                                        <div *ngIf="userDic[rowData.createur_id].phone" class="ui-g-12 ui-md-4">
                                            <div class="ui-g-6 ui-md-6"><b
                                                    style="text-align:left !important;">Téléphone:</b> </div>
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                {{userDic[rowData.createur_id].phone}}</div>
                                        </div>
                                        <div class="ui-g-12 ui-md-4">
                                            <div class="ui-g-6 ui-md-6"><b style="text-align:left !important;">Adresse
                                                    mail:</b> </div>
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                {{userDic[rowData.createur_id].email}}</div>
                                        </div>
                                    </div>
                                    <div *ngIf="userDic[rowData.createur_id].adresse" class="ui-g-12 ui-md-12">
                                        <div class="ui-g-12 ui-md-4">
                                            <div class="ui-g-6 ui-md-6"><b style="text-align:left !important;">Adresse
                                                    postale:</b> </div>
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                {{userDic[rowData.createur_id].adresse}}</div>
                                        </div>
                                        <div class="ui-g-12 ui-md-4">
                                            <div class="ui-g-6 ui-md-6"><b style="text-align:left !important;">Rôle:</b>
                                            </div>
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                {{(userDic[rowData.createur_id].role=='user')?'Utilisateur':userDic[rowData.createur_id].role}}
                                            </div>
                                        </div>
                                        <div *ngIf="userDic[rowData.createur_id].service_id" class="ui-g-12 ui-md-4">
                                            <div class="ui-g-6 ui-md-6"><b
                                                    style="text-align:left !important;">Service:</b> </div>
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                {{serviceDic[userDic[rowData.createur_id]?.service_id]?.label}}</div>
                                        </div>
                                    </div>
                                    <div class="ui-g-12 ui-md-12" *ngIf="userDic[rowData.createur_id].type">
                                        <div class="ui-g-6 ui-md-6"><b style="text-align:left !important;">Statut:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                            {{userDic[rowData.createur_id].type}}</div>
                                    </div>

                                    <div class="ui-g-12 ui-md-12"
                                        *ngIf="userDic[rowData.createur_id].type && (userDic[rowData.createur_id].type=='Salarié' || userDic[rowData.createur_id].type=='Alternant/Stagiaire') && userDic[rowData.createur_id].entreprise">
                                        <div class="ui-g-6 ui-md-6"><b
                                                style="text-align:left !important;">Entreprise:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                            {{userDic[rowData.createur_id].entreprise}}
                                        </div>
                                    </div>

                                    <div class="ui-g-12 ui-md-12"
                                        *ngIf="userDic[rowData.createur_id].type && (userDic[rowData.createur_id].type=='Etudiant' || userDic[rowData.createur_id].type=='Alternant/Stagiaire')">
                                        <div *ngIf="userDic[rowData.createur_id].campus" class="ui-g-12 ui-md-6">
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                <b style="text-align:left !important;">Campus:</b>
                                            </div>
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                {{userDic[rowData.createur_id].campus}}</div>
                                        </div>
                                        <div *ngIf="userDic[rowData.createur_id].formation" class="ui-g-12 ui-md-6">
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                <b style="text-align:left !important;">Formation:</b>
                                            </div>
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                {{userDic[rowData.createur_id].formation}}</div>
                                        </div>
                                    </div>
                                </div>
                            </p-fieldset>
                            <p-fieldset *ngIf="rowData.isReverted" legend="Informations du renvoie"
                                [style]="{'color':'green','font-weight': 'bold'}">
                                <div class="p-grid ui-fluid" style="color: black;font-weight:normal;">
                                    <div class="ui-g-4 ui-md-4">
                                        <div class="ui-g-6 ui-md-6"><b style="text-align:left !important;">Envoyeur:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                            {{userDic[rowData.user_revert].firstname |
                                            titlecase }} {{userDic[rowData.user_revert].lastname | titlecase
                                            }} </div>
                                    </div>
                                    <div class="ui-g-4 ui-md-4">
                                        <div class="ui-g-6 ui-md-6"><b
                                                style="text-align:left !important;">Justificatif:</b> </div>
                                        <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                            {{rowData.justificatif}}</div>
                                    </div>
                                    <div class="ui-g-4 ui-md-4">
                                        <div class="ui-g-6 ui-md-6"><b style="text-align:left !important;">Date:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                            {{rowData.date_revert | date:'dd/MM/yyyy HH:mm'}}</div>
                                    </div>
                                </div>
                            </p-fieldset>
                        </td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
    </div>
</div>
<div class="grid">
    <div class="col-10 col-offset-1">
        <h3>Mes tickets en cours de traitement</h3>
        <div class="col-12 card shadow-lg my-5">
            <p-table #dt2 *ngIf="AccAffList" [columns]="cols" [value]="AccAffList" pDroppable="QueueToAccAff"
                (onDrop)="dragQueueToAccAff($event)" dataKey="_id" rowExpandMode="single" [rows]="4" [paginator]="true"
                [pageLinks]="5" [responsive]="true" [totalRecords]="AccAffList.length"
                (sortFunction)="customSort($event)" [customSort]="true" [globalFilterFields]="['customid','description']">

                <ng-template pTemplate="caption">
                    <div class="p-d-flex" style="display: flex;">
                        <p-dropdown *ngIf="token['role']=='Admin'" placeholder="Choissisez un service" filter="true"
                            [options]="dropdownService" (onChange)="dt2.filter($event.value, 'service_id', 'equals')">
                        </p-dropdown>
                        <span style="margin-left:2% ;">

                            <p-dropdown [options]="showStatutTab2"
                                (onChange)="dt2.filter($event.value, 'statut', 'equals')">
                            </p-dropdown>
                        </span>
                        <span style="margin-left:2% ;">
                            <p-dropdown placeholder="Choissisez un sujet" filter="true" [options]="showSujetAccAff"
                                (onChange)="dt2.filter($event.value, 'sujet_id', 'equals')"></p-dropdown>
                        </span>
                        <input style="margin-left:2%;" pInputText type="text" (input)="dt2.filterGlobal($event.target.value, 'contains')" placeholder="Recherche" />
                    </div>
                </ng-template>

                <div id="top">
                    <ng-template pTemplate="header" let-columns>
                        <tr>
                            <th style="width: 3rem"></th>
                            <th style="text-decoration: underline;padding-top: 5%;" pSortableColumn="service">
                                Service <p-sortIcon field="service"></p-sortIcon>

                            </th>
                            <th style="text-decoration: underline;padding-top: 5%;" pSortableColumn="sujet"> Sujet
                                <p-sortIcon field="sujet"></p-sortIcon>
                            </th>
                            <th style="text-decoration: underline;padding-top: 5%;" pSortableColumn="date_affec_accep">
                                Date d'acceptation

                                <p-sortIcon field="date_affec_accep"></p-sortIcon>
                            </th>
                            <th style="text-decoration: underline;padding-top: 5%;">
                                Temps de traitement
                            </th>
                            <th style="text-decoration: underline;padding-top: 5%; " pSortableColumn="isAffected">
                                Désignation <p-sortIcon field="isAffected"></p-sortIcon>
                            </th>
                            <th style="text-decoration: underline ; padding-top: 5%;" pSortableColumn="statut">
                                Statut <p-sortIcon field="statut"></p-sortIcon>
                            </th>
                            <th style="text-decoration: underline;padding-top: 5%;">
                                Action
                            </th>
                        </tr>

                    </ng-template>
                </div>
                <ng-template pTemplate="body" let-rowData let-columns="columns" let-expanded="expanded">
                    <tr (onDragStart)="dragStart($event, rowData)" (onDragEnd)="dragEnd($event)"
                        *ngIf="sujetList[rowData.sujet_id]" [pSelectableRow]="rowData" pDroppable="QueueToAccAff">
                        <td>
                            <button type="button" pButton [pRowToggler]="rowData" class="expanded"
                                [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"
                                (click)='loadMessages(rowData)'></button>
                        </td>
                        <td>
                            {{serviceList[sujetList[rowData.sujet_id].service_id]}}
                        </td>
                        <td>
                            {{sujetList[rowData.sujet_id].label}}
                        </td>
                        <td>
                            {{rowData.date_affec_accep | date:'dd/MM/yyyy HH:mm'}}
                        </td>
                        <td>
                            {{showWorkingTime(rowData)}}
                        </td>

                        <td *ngIf="rowData.isAffected">
                            Affecté
                        </td>
                        <td *ngIf="!rowData.isAffected">
                            Accepté
                        </td>
                        <td [pSelectableRow]="rowData">
                            {{rowData.statut}}
                        </td>
                        <td>
                            <i *ngIf="rowData.statut!='Traité'" pTooltip="Traiter" class="pi pi-cog"
                                (click)="toggleFormCommentAdd(rowData);showFormAddComment=true"> </i>
                            <i *ngIf="rowData.statut!='Traité'" pTooltip="Renvoyer le ticket dans la queue d'entrée"
                                class="pi pi-replay" (click)="toggleRevertForm(rowData)"></i>
                        </td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="rowexpansion" let-rowData>
                    <tr style="text-align: left; margin-left: 2em; background-color:white;">
                        <td [attr.colspan]="8">
                            <p-fieldset legend="Informations du ticket"
                                [style]="{'color':'green','font-weight': 'bold'}">
                                <div class="p-grid ui-fluid" style="color: black;font-weight:normal;">
                                    <div class="ui-g-6 ui-md-6">
                                        <div class="ui-g-4 ui-md-4"><b style="text-align:left !important;">Statut:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                            {{rowData.statut}} </div>
                                    </div>
                                    <div class="ui-g-6 ui-md-6">
                                        <div class="ui-g-6 ui-md-6"><b
                                                style="text-align:left !important;">Description:</b> </div>
                                        <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                            {{rowData.description}}</div>
                                    </div>
                                    <div class="ui-g-6 ui-md-6">
                                        <div class="ui-g-6 ui-md-6"><b style="text-align:left !important;">Date de
                                                création:</b> </div>
                                        <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                            {{rowData.date_ajout | date:'dd/MM/yyyy HH:mm'}}</div>
                                    </div>
                                    <div class="ui-g-6 ui-md-6">
                                        <div class="ui-g-6 ui-md-6"><b style="text-align:left !important;">Numéro de
                                                ticket:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                            {{rowData.customid}} </div>
                                    </div>
                                </div>
                            </p-fieldset>
                            <p-fieldset legend="Créateur du ticket" [style]="{'color':'green','font-weight': 'bold'}">
                                <div class="p-grid ui-fluid" style="color: black;font-weight:normal">
                                    <div class="ui-g-12 ui-md-12">
                                        <div class="ui-g-12 ui-md-4">
                                            <div class="ui-g-6 ui-md-6"><b style="text-align:left !important;">Nom et
                                                    Prénom:</b></div>
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                {{userDic[rowData.createur_id].firstname | titlecase }}
                                                {{userDic[rowData.createur_id].lastname | titlecase}}</div>
                                        </div>
                                        <div *ngIf="userDic[rowData.createur_id].phone" class="ui-g-12 ui-md-4">
                                            <div class="ui-g-6 ui-md-6"><b
                                                    style="text-align:left !important;">Téléphone:</b> </div>
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                {{userDic[rowData.createur_id].phone}}</div>
                                        </div>
                                        <div *ngIf="userDic[rowData.createur_id].email" class="ui-g-12 ui-md-4">
                                            <div class="ui-g-6 ui-md-6"><b style="text-align:left !important;"> Adresse
                                                    mail:</b></div>
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                {{userDic[rowData.createur_id].email}}</div>
                                        </div>
                                    </div>
                                    <div class="ui-g-12 ui-md-12">
                                        <div class="ui-g-12 ui-md-4" *ngIf="userDic[rowData.createur_id].adresse">
                                            <div class="ui-g-6 ui-md-6"><b style="text-align:left !important;">Adresse
                                                    postale:</b> </div>
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                {{userDic[rowData.createur_id].adresse}}</div>
                                        </div>
                                        <div class="ui-g-12 ui-md-4">
                                            <div class="ui-g-6 ui-md-6"><b style="text-align:left !important;">Rôle:</b>
                                            </div>
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                {{(userDic[rowData.createur_id].role=='user')?'Utilisateur':userDic[rowData.createur_id].role}}
                                            </div>
                                        </div>
                                        <div *ngIf="userDic[rowData.createur_id].service_id" class="ui-g-12 ui-md-4">
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                <b style="text-align:left !important;">Service:</b>
                                            </div>
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                {{serviceDic[userDic[rowData.createur_id]?.service_id]?.label}}</div>
                                        </div>
                                    </div>

                                    <div class="ui-g-12 ui-md-12" *ngIf="userDic[rowData.createur_id].type">
                                        <div class="ui-g-6 ui-md-6"><b style="text-align:left !important;">Statut:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                            {{userDic[rowData.createur_id].type}}</div>
                                    </div>

                                    <div class="ui-g-12 ui-md-12"
                                        *ngIf="userDic[rowData.createur_id].type && (userDic[rowData.createur_id].type=='Salarié' || userDic[rowData.createur_id].type=='Alternant/Stagiaire') && userDic[rowData.createur_id].entreprise">
                                        <div class="ui-g-6 ui-md-6"><b
                                                style="text-align:left !important;">Entreprise:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                            {{userDic[rowData.createur_id].entreprise}}
                                        </div>
                                    </div>

                                    <div class="ui-g-12 ui-md-12"
                                        *ngIf="userDic[rowData.createur_id].type && (userDic[rowData.createur_id].type=='Etudiant' || userDic[rowData.createur_id].type=='Alternant/Stagiaire')">
                                        <div *ngIf="userDic[rowData.createur_id].campus" class="ui-g-12 ui-md-6">
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                <b style="text-align:left !important;">Campus:</b>
                                            </div>
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                {{userDic[rowData.createur_id].campus}}</div>
                                        </div>
                                        <div *ngIf="userDic[rowData.createur_id].formation" class="ui-g-12 ui-md-6">
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                <b style="text-align:left !important;">Formation:</b>
                                            </div>
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                {{userDic[rowData.createur_id].formation}}</div>
                                        </div>
                                    </div>
                                </div>
                            </p-fieldset>
                            <p-fieldset *ngIf="comments && comments.length!=0" legend="Messages"
                                [style]="{'color':'green','font-weight': 'bold'}">
                                <div class="badyT">

                                    <p-table [value]="comments" dataKey="id">
                                        <ng-template pTemplate="body" let-message>
                    <tr *ngIf="message.user_id!=token['id']">
                        <td>
                            <span class="ui-g-6 ui-md-6">
                                <div class="ui-g-12 ui-md-12">
                                    <button style="cursor: pointer;" *ngIf="message.document"
                                        class="pi pi-paperclip ui-g-1 ui-md-1" id="charger2"
                                        (click)="downloadFile(message)"><i class="fa fa-spinner fa-spin fa-fw"
                                            *ngIf="loadingMessage==message._id"></i></button>
                                    <span class="ui-g-11 ui-md-11" id="messageUser"> {{message.description}} </span>
                                </div>
                                <span id="soustitre" class="ui-g-11 ui-md-11">
                                    {{userDic[message.user_id].firstname}} {{userDic[message.user_id].lastname}} :
                                    {{(userDic[message.user_id].role=='user')?'Utilisateur':userDic[message.user_id].role}}
                                    {{message.date_ajout | date:'dd/MM/yyyy HH:mm'}}
                                </span>
                            </span>
                        </td>
                    </tr>
                    <tr *ngIf="message.user_id==token['id']">
                        <td>
                            <span class="ui-g-6 ui-md-6" style="float: right;">
                                <div class="ui-g-12 ui-md-12">
                                    <button style="cursor: pointer;" *ngIf="message.document"
                                        class="pi pi-paperclip ui-g-1 ui-md-1" id="charger2"
                                        (click)="downloadFile(message)">
                                        <i class="fa fa-spinner fa-spin fa-fw" *ngIf="loadingMessage==message._id">
                                        </i>
                                    </button>
                                    <span class="ui-g-12 ui-md-11" id="messageAgent"> {{message.description}} </span>
                                </div>
                                <span id="soustitre" class=" ui-g-11 ui-md-11">
                                    {{userDic[message.user_id].firstname}} {{userDic[message.user_id].lastname}} :
                                    {{(userDic[message.user_id].role=='user')?'Utilisateur':userDic[message.user_id].role}}
                                    {{message.date_ajout | date:'dd/MM/yyyy HH:mm'}}

                                </span>

                            </span>
                        </td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
        </p-fieldset>
        </td>
        </tr>
        </ng-template>
        </p-table>
    </div>
</div>
</div>
<div class="grid">
    <div class="col-10 col-offset-1">
        <h3 *ngIf="token['role']!='Admin'">Les tickets de mon service</h3>
        <h3 *ngIf="token['role']=='Admin'">Les tickets de tous les services</h3>
        <div class="col-12 card shadow-lg my-5">
            <p-table #dt3 *ngIf="AccAffList" [columns]="cols" [value]="allTickets" dataKey="_id" rowExpandMode="single"
                [rows]="4" [paginator]="true" [pageLinks]="5" [responsive]="true" [totalRecords]="allTickets.length"
                (sortFunction)="customSort($event)" [customSort]="true" [globalFilterFields]="['customid','description']">

                <ng-template pTemplate="caption">
                    <div class="p-input-icon-left p-ml-auto">
                        <div style="display: flex;">
                            <p-dropdown *ngIf="token['role']=='Admin'" filter="true" placeholder="Tous"
                                [options]="dropdownService"
                                (onChange)="dt3.filter($event.value, 'service_id', 'equals')"></p-dropdown>
                            <span style="margin-left: 2%;">
                                <p-dropdown [options]="showStatut"
                                    (onChange)="dt3.filter($event.value, 'statut', 'equals')"></p-dropdown>
                            </span>
                            <span style="margin-left: 2%;">
                                <p-dropdown placeholder="Choissisez un sujet" filter="true" [options]="showSujetAll"
                                    (onChange)="dt3.filter($event.value, 'sujet_id', 'equals')"></p-dropdown>
                            </span>
                            <input style="margin-left:2%;" pInputText type="text" (input)="dt3.filterGlobal($event.target.value, 'contains')" placeholder="Recherche" />
                        </div>
                    </div>
                </ng-template>

                <ng-template pTemplate="header" let-columns>
                    <tr>
                        <th style="width: 3rem"></th>
                        <th style="text-decoration: underline;padding-top: 5%;" pSortableColumn="service">
                            Service <p-sortIcon field="service"></p-sortIcon>
                        </th>
                        <th style="text-decoration: underline;padding-top: 5%;" pSortableColumn="sujet"> Sujet
                            <p-sortIcon field="sujet"></p-sortIcon>
                        </th>
                        <th style="text-decoration: underline;padding-top: 5%;" pSortableColumn="date_affec_accep"> Date
                            d'acceptation <p-sortIcon field="date_affec_accep"></p-sortIcon>

                        </th>
                        <th style="text-decoration: underline;padding-top: 5%;">
                            Temps de traitement
                        </th>
                        <th style="text-decoration: underline;padding-top: 5%;" pSortableColumn="isAffected">
                            Désignation <p-sortIcon field="isAffected"></p-sortIcon>
                        </th>
                        <th style="text-decoration: underline ; padding-top: 5%;" pSortableColumn="statut">
                            Statut <p-sortIcon field="statut"></p-sortIcon>
                        </th>
                        <th style="text-decoration: underline;padding-top: 5%;" pSortableColumn="agent">
                            Agent <p-sortIcon field="agent"></p-sortIcon>
                        </th>
                        <th *ngIf="token['role']!='Agent'" style="padding-top: 5%;">
                            Action
                        </th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-rowData let-columns="columns" let-expanded="expanded">
                    <tr *ngIf="sujetList[rowData.sujet_id]">
                        <td>
                            <button type="button" pButton [pRowToggler]="rowData" class="expanded"
                                [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"
                                (click)='loadMessages(rowData,"All",expanded)'></button>
                        </td>
                        <td>
                            {{serviceList[sujetList[rowData.sujet_id].service_id]}}
                        </td>
                        <td>
                            {{sujetList[rowData.sujet_id].label}}
                        </td>
                        <td>
                            {{rowData.date_affec_accep | date:'dd/MM/yyyy HH:mm'}}
                        </td>
                        <td>
                            {{showWorkingTime(rowData)}}
                        </td>
                        <td *ngIf="rowData.isAffected">
                            Affecté
                        </td>
                        <td *ngIf="!rowData.isAffected">
                            Accepté
                        </td>
                        <td>
                            {{rowData.statut}}
                        </td>
                        <td *ngIf="userDic[rowData.agent_id]">
                            {{userDic[rowData.agent_id].firstname}} {{userDic[rowData.agent_id].lastname}}
                        </td>
                        <td *ngIf="token['role']!='Agent'">
                            <i *ngIf="rowData.statut!='Traité'" pTooltip="Renvoyer le ticket dans la queue d'entrée"
                                class=" pi pi-replay" (click)="toggleRevertForm(rowData)"></i>
                        </td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="rowexpansion" let-rowData>
                    <tr style="text-align: left; margin-left: 2em; background-color:white;">
                        <td [attr.colspan]="(token['role']!='Agent')? 9 : 8">
                            <p-fieldset legend="Informations du ticket"
                                [style]="{'color':'green','font-weight': 'bold'}">
                                <div class="p-grid ui-fluid" style="color: black;font-weight:normal;">
                                    <div class="ui-g-6 ui-md-6">
                                        <div class="ui-g-4 ui-md-4"><b style="text-align:left !important;">Statut:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                            {{rowData.statut}} </div>
                                    </div>
                                    <div class="ui-g-6 ui-md-6">
                                        <div class="ui-g-6 ui-md-6"><b
                                                style="text-align:left !important;">Description:</b> </div>
                                        <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                            {{rowData.description}}</div>
                                    </div>
                                    <div class="ui-g-6 ui-md-6">
                                        <div class="ui-g-6 ui-md-6"><b style="text-align:left !important;">Date de
                                                création:</b> </div>
                                        <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                            {{rowData.date_ajout | date:'dd/MM/yyyy HH:mm'}}</div>
                                    </div>
                                    <div class="ui-g-6 ui-md-6">
                                        <div class="ui-g-6 ui-md-6"><b style="text-align:left !important;">Numéro de
                                                ticket:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                            {{rowData.customid}} </div>
                                    </div>
                                </div>
                            </p-fieldset>
                            <p-fieldset legend="Créateur du ticket" [style]="{'color':'green','font-weight': 'bold'}">
                                <div class="p-grid ui-fluid" style="color: black;font-weight:normal">
                                    <div class="ui-g-12 ui-md-12">
                                        <div class="ui-g-12 ui-md-4">
                                            <div class="ui-g-6 ui-md-6"><b style="text-align:left !important;">Nom
                                                    et Prénom:</b></div>
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                {{userDic[rowData.createur_id].firstname | titlecase }}
                                                {{userDic[rowData.createur_id].lastname | titlecase}}</div>
                                        </div>
                                        <div *ngIf="userDic[rowData.createur_id].phone" class="ui-g-12 ui-md-4">
                                            <div class="ui-g-6 ui-md-6"><b
                                                    style="text-align:left !important;">Téléphone:</b> </div>
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                {{userDic[rowData.createur_id].phone}}</div>
                                        </div>
                                        <div *ngIf="userDic[rowData.createur_id].email" class="ui-g-12 ui-md-4">
                                            <div class="ui-g-6 ui-md-6"><b style="text-align:left !important;">Adresse
                                                    mail:</b></div>
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                {{userDic[rowData.createur_id].email}}</div>
                                        </div>
                                    </div>
                                    <div *ngIf="userDic[rowData.createur_id].adresse" class="ui-g-12 ui-md-12">
                                        <div class="ui-g-12 ui-md-4">
                                            <div class="ui-g-6 ui-md-6"><b style="text-align:left !important;">Adresse
                                                    postale:</b></div>
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                {{userDic[rowData.createur_id].adresse}}</div>
                                        </div>
                                        <div class="ui-g-12 ui-md-4">
                                            <div class="ui-g-6 ui-md-6"><b style="text-align:left !important;">Rôle:</b>
                                            </div>
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                {{(userDic[rowData.createur_id].role=='user')?'Utilisateur':userDic[rowData.createur_id].role}}
                                            </div>
                                        </div>
                                        <div *ngIf="userDic[rowData.createur_id].service_id" class="ui-g-12 ui-md-4">
                                            <div class="ui-g-6 ui-md-6"><b
                                                    style="text-align:left !important;">Service:</b> </div>
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                {{serviceDic[userDic[rowData.createur_id]?.service_id].label}}</div>
                                        </div>
                                    </div>
                                </div>
                            </p-fieldset>
                            <p-fieldset legend="Agent du ticket" [style]="{'color':'green','font-weight': 'bold'}">
                                <div class="p-grid ui-fluid" style="color: black;font-weight:normal">
                                    <div class="ui-g-12 ui-md-12">
                                        <div class="ui-g-12 ui-md-4">
                                            <div class="ui-g-6 ui-md-6"><b style="text-align:left !important;">Nom et
                                                    Prénom:</b> </div>
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                {{userDic[rowData.agent_id].firstname | titlecase }}
                                                {{userDic[rowData.agent_id].lastname | titlecase}}
                                            </div>
                                        </div>
                                        <div *ngIf="userDic[rowData.agent_id].phone" class="ui-g-12 ui-md-4">
                                            <div class="ui-g-6 ui-md-6"><b
                                                    style="text-align:left !important;">Téléphone:</b> </div>
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                {{userDic[rowData.agent_id].phone}}</div>
                                        </div>
                                        <div class="ui-g-12 ui-md-4">
                                            <div class="ui-g-6 ui-md-6"><b style="text-align:left !important;">Adresse
                                                    mail:</b> </div>
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                {{userDic[rowData.agent_id].email}}</div>
                                        </div>
                                    </div>
                                    <div class="ui-g-12 ui-md-12">
                                        <div class="ui-g-12 ui-md-4" *ngIf="userDic[rowData.agent_id].adresse">
                                            <div class="ui-g-6 ui-md-6"><b style="text-align:left !important;">Adresse
                                                    postale:</b> </div>
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                {{userDic[rowData.agent_id].adresse}}</div>
                                        </div>
                                        <div class="ui-g-12 ui-md-4">
                                            <div class="ui-g-6 ui-md-6"><b style="text-align:left !important;">Rôle:</b>
                                            </div>
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                {{userDic[rowData.agent_id].role}}</div>
                                        </div>
                                        <div *ngIf="serviceDic[userDic[rowData.agent_id].service_id]"
                                            class="ui-g-12 ui-md-4">
                                            <div class="ui-g-6 ui-md-6"><b
                                                    style="text-align:left !important;">Service:</b> </div>
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                {{serviceDic[userDic[rowData.agent_id]?.service_id].label}}</div>
                                        </div>
                                    </div>
                                    <div class="ui-g-12 ui-md-12" *ngIf="userDic[rowData.createur_id].type">
                                        <div class="ui-g-6 ui-md-6"><b style="text-align:left !important;">Statut:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                            {{userDic[rowData.createur_id].type}}</div>
                                    </div>

                                    <div class="ui-g-12 ui-md-12"
                                        *ngIf="userDic[rowData.createur_id].type && (userDic[rowData.createur_id].type=='Salarié' || userDic[rowData.createur_id].type=='Alternant/Stagiaire') && userDic[rowData.createur_id].entreprise">
                                        <div class="ui-g-6 ui-md-6"><b
                                                style="text-align:left !important;">Entreprise:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                            {{userDic[rowData.createur_id].entreprise}}
                                        </div>
                                    </div>

                                    <div class="ui-g-12 ui-md-12"
                                        *ngIf="userDic[rowData.createur_id].type && (userDic[rowData.createur_id].type=='Etudiant' || userDic[rowData.createur_id].type=='Alternant/Stagiaire')">
                                        <div *ngIf="userDic[rowData.createur_id].campus" class="ui-g-12 ui-md-6">
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                <b style="text-align:left !important;">Campus:</b>
                                            </div>
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                {{userDic[rowData.createur_id].campus}}</div>
                                        </div>
                                        <div *ngIf="userDic[rowData.createur_id].formation" class="ui-g-12 ui-md-6">
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                <b style="text-align:left !important;">Formation:</b>
                                            </div>
                                            <div class="ui-g-6 ui-md-6" style="text-align:left !important;">
                                                {{userDic[rowData.createur_id].formation}}</div>
                                        </div>
                                    </div>
                                </div>
                            </p-fieldset>
                            <p-fieldset *ngIf="comments && comments.length!=0" legend="Messages"
                                [style]="{'color':'green','font-weight': 'bold'}">
                                <div class="badyT">

                                    <p-table [value]="comments" dataKey="id">
                                        <ng-template pTemplate="body" let-message>
                    <tr *ngIf="message.user_id==rowData.createur_id">
                        <td>
                            <span class="ui-g-6 ui-md-6">
                                <div class="ui-g-12 ui-md-12">
                                    <button style="cursor: pointer;" *ngIf="message.document"
                                        class="pi pi-paperclip ui-g-1 ui-md-1" id="charger2"
                                        (click)="downloadFile(message)"><i class="fa fa-spinner fa-spin fa-fw"
                                            *ngIf="loadingMessage==message._id"></i></button>

                                    <span class="ui-g-11 ui-md-11" id="messageUser"> {{message.description}} </span>
                                </div>
                                <span id="soustitre" class="ui-g-11 ui-md-11">
                                    {{userDic[message.user_id].firstname}} {{userDic[message.user_id].lastname}} :
                                    {{(userDic[message.user_id].role=='user')?'Utilisateur':userDic[message.user_id].role}}
                                    {{message.date_ajout | date:'dd/MM/yyyy HH:mm'}}
                                </span>
                            </span>
                        </td>
                    </tr>
                    <tr *ngIf="message.user_id!=rowData.createur_id">
                        <td>
                            <span class="ui-g-6 ui-md-6" style="float: right;">
                                <div class="ui-g-12 ui-md-12">
                                    <button style="cursor: pointer;" *ngIf="message.document"
                                        class="pi pi-paperclip ui-g-1 ui-md-1" id="charger2"
                                        (click)="downloadFile(message)">
                                        <i class="fa fa-spinner fa-spin fa-fw" *ngIf="loadingMessage==message._id">
                                        </i>
                                    </button>
                                    <span class="ui-g-12 ui-md-11" id="messageAgent"> {{message.description}} </span>
                                </div>
                                <span id="soustitre" class=" ui-g-11 ui-md-11">
                                    {{userDic[message.user_id].firstname}} {{userDic[message.user_id].lastname}} :
                                    {{(userDic[message.user_id].role=='user')?'Utilisateur':userDic[message.user_id].role}}
                                    {{message.date_ajout | date:'dd/MM/yyyy HH:mm'}}
                                </span>
                            </span>
                        </td>
                    </tr>
                </ng-template>

            </p-table>
        </div>
        </p-fieldset>
        </td>
        </tr>
        </ng-template>
        </p-table>
    </div>
</div>
</div>