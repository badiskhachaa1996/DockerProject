<!-- Formulaire d'ajout d'une entreprise -->
<div *ngIf="showFormAddEntreprise" class="grid">
    <div class="xl:col-8 xl:col-offset-2 col-12">
        <p-card>
            <div class="p-grid">
                <i class="pi pi-times" style="float:right; font-size: 20px;" (click)="showFormAddEntreprise = false; resetForms();"></i>
                <form class="col-8 col-offset-2" [formGroup]="formAddEntreprise" (ngSubmit)="onAddEntreprise()">

                    <h3>Ajouter une entreprise</h3>
                    <div class="p-grid">

                        <div class="ui-g-12 ui-md-12">
                            <input type="text" formControlName="r_sociale" class="form-control col-12"
                                placeholder="Raison sociale" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="fm_juridique" class="form-control col-12"
                                placeholder="Form juridique" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="vip" class="form-control col-12"
                                placeholder="VIP" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="type_ent" class="form-control col-12"
                                placeholder="Type d'entreprise" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <p-toggleButton onLabel="Interne" offLabel="Non Interne" formControlName="isInterne">
                            </p-toggleButton>
                        </div>

                        <div class="ui-g-12 ui-md-12">
                            <input type="text" formControlName="siret" class="form-control col-12"
                                placeholder="Siret" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="code_ape_naf" class="form-control col-12"
                                placeholder="Code APE NAF" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="num_tva" class="form-control col-12"
                                placeholder="Numéro TVA" pInputText>
                        </div>
                             
                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="nom_contact" class="form-control col-12"
                                placeholder="Nom contact" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="prenom_contact" class="form-control col-12"
                                placeholder="Prénom contact" pInputText>
                        </div>

                        <div class="ui-g-12 ui-md-12">
                            <input type="text" formControlName="fc_contact" class="form-control col-12"
                                placeholder="Fonction Contact" pInputText>
                        </div>

                        <div class="ui-g-12 ui-md-12">
                            <input type="text" formControlName="email_contact" class="form-control col-12"
                                placeholder="Email contact" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="phone_contact" class="form-control col-12"
                                placeholder="Numéro de téléphone contact" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="nom_contact_2nd" class="form-control col-12"
                                placeholder="Nom contact sécondaire" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="prenom_contact_2nd" class="form-control col-12"
                                placeholder="Prénom contact sécondaire" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="fc_contact_2nd" class="form-control col-12"
                                placeholder="Fonction contact sécondaire" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="email_contact_2nd" class="form-control col-12"
                                placeholder="Email contact sécondaire" pInputText>
                        </div>
                         
                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="phone_contact_2nd" class="form-control col-12"
                                placeholder="Numéro de téléphone contact sécondaire" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="pays_adresse" class="form-control col-12"
                                placeholder="Pays" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="ville_adresse" class="form-control col-12"
                                placeholder="Ville" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="rue_adresse" class="form-control col-12"
                                placeholder="Nom de la rue" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="number" formControlName="numero_adresse" class="form-control col-12"
                                placeholder="Numéro de la rue" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="postal_adresse" class="form-control col-12"
                                placeholder="Code postale" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="email" formControlName="email" class="form-control col-12"
                                placeholder="Email" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="phone" class="form-control col-12"
                                placeholder="Numéro de téléphone de l'entreprise" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="website" class="form-control col-12"
                                placeholder="Site internet" pInputText>
                        </div>

                        <div class="ui-g-12 ui-md-12">
                            <input type="text" formControlName="financeur" class="form-control col-12"
                                placeholder="Financeur" pInputText>
                        </div>

                        <button pButton type="submit" label="Ajouter l'entreprise"
                                [disabled]="formAddEntreprise.invalid"
                                style="margin-left: 77%;"></button>

                    </div>

                </form>
            </div>
        </p-card>
    </div>
</div>









<!-- Formulaire de mise à jour d'une entreprise -->
<div *ngIf="showFormUpdateEntreprise" class="grid">
    <div class="xl:col-8 xl:col-offset-2 col-12">
        <p-card>
            <div class="p-grid">
                <i class="pi pi-times" style="float:right; font-size: 20px;" (click)="showFormUpdateEntreprise = false; resetForms();"></i>
                <form class="col-8 col-offset-2" [formGroup]="formUpdateEntreprise" (ngSubmit)="onUpdateEntreprise()">

                    <h3>Ajouter une entreprise</h3>
                    <div class="p-grid">

                        <div class="ui-g-12 ui-md-12">
                            <input type="text" formControlName="r_sociale" class="form-control col-12"
                                placeholder="Raison sociale" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="fm_juridique" class="form-control col-12"
                                placeholder="Form juridique" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="vip" class="form-control col-12"
                                placeholder="VIP" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="type_ent" class="form-control col-12"
                                placeholder="Type d'entreprise" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <p-toggleButton onLabel="Interne" offLabel="Non Interne" formControlName="isInterne">
                            </p-toggleButton>
                        </div>

                        <div class="ui-g-12 ui-md-12">
                            <input type="text" formControlName="siret" class="form-control col-12"
                                placeholder="Siret" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="code_ape_naf" class="form-control col-12"
                                placeholder="Code APE NAF" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="num_tva" class="form-control col-12"
                                placeholder="Numéro TVA" pInputText>
                        </div>
                             
                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="nom_contact" class="form-control col-12"
                                placeholder="Nom contact" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="prenom_contact" class="form-control col-12"
                                placeholder="Prénom contact" pInputText>
                        </div>

                        <div class="ui-g-12 ui-md-12">
                            <input type="text" formControlName="fc_contact" class="form-control col-12"
                                placeholder="Fonction Contact" pInputText>
                        </div>

                        <div class="ui-g-12 ui-md-12">
                            <input type="text" formControlName="email_contact" class="form-control col-12"
                                placeholder="Email contact" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="phone_contact" class="form-control col-12"
                                placeholder="Numéro de téléphone contact" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="nom_contact_2nd" class="form-control col-12"
                                placeholder="Nom contact sécondaire" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="prenom_contact_2nd" class="form-control col-12"
                                placeholder="Prénom contact sécondaire" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="fc_contact_2nd" class="form-control col-12"
                                placeholder="Fonction contact sécondaire" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="email_contact_2nd" class="form-control col-12"
                                placeholder="Email contact sécondaire" pInputText>
                        </div>
                         
                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="phone_contact_2nd" class="form-control col-12"
                                placeholder="Numéro de téléphone contact sécondaire" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="pays_adresse" class="form-control col-12"
                                placeholder="Pays" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="ville_adresse" class="form-control col-12"
                                placeholder="Ville" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="rue_adresse" class="form-control col-12"
                                placeholder="Nom de la rue" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="number" formControlName="numero_adresse" class="form-control col-12"
                                placeholder="Numéro de la rue" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="postal_adresse" class="form-control col-12"
                                placeholder="Code postale" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="email" formControlName="email" class="form-control col-12"
                                placeholder="Email" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="phone" class="form-control col-12"
                                placeholder="Numéro de téléphone de l'entreprise" pInputText>
                        </div>

                        <div class="ui-g-6 ui-md-6">
                            <input type="text" formControlName="website" class="form-control col-12"
                                placeholder="Site internet" pInputText>
                        </div>

                        <div class="ui-g-12 ui-md-12">
                            <input type="text" formControlName="financeur" class="form-control col-12"
                                placeholder="Financeur" pInputText>
                        </div>

                        <button pButton type="submit" label="Modifier l'entreprise"
                                [disabled]="formUpdateEntreprise.invalid"
                                style="margin-left: 75%;"></button>

                    </div>

                </form>
            </div>
        </p-card>
    </div>
</div>











<!-- Table d'affichage de la liste des entreprises -->
<div class="grid">
    <div class="col-10 col-offset-1">
        <!-- Bouton d'ajout d'une nouvelle entreprise -->
        <button pButton (click)="showFormAddEntreprise = true; showFormUpdateEntreprise = false;"
        type="button" label="Nouvelle entreprise" style="float:right;"></button>
        <h3>Entreprises</h3>
        <div class="col-12 card shadow-lg my-5">
            <!-- input de recherche -->
            <input style="margin:5px;" pInputText type="text"
                (input)="dt1.filterGlobal($event.target.value, 'contains')" placeholder="Recherche" />

            <p-table #dt1 [globalFilterFields]="['r_sociale', 'fm_juridique', 'siret', 'isInterne', 'website', 'vip']" [rows]="5"
                [pageLinks]="5" [paginator]="true" rowExpandMode="single" [value]="entreprises" dataKey="_id" 
                [totalRecords]="entreprises.length" responsiveLayout="scroll">
                <ng-template pTemplate="header">
                    <tr>
                        <th style="width: 3rem"></th>
                        <th pSortableColumn="r_sociale">Raison sociale <p-sortIcon field="r_sociale"></p-sortIcon></th>
                        <th pSortableColumn="fm_juridique">Forme juridique <p-sortIcon field="fm_juridique"></p-sortIcon></th>
                        <th pSortableColumn="siret">Siret <p-sortIcon field="siret"></p-sortIcon></th>
                        <th pSortableColumn="website">Site internet <p-sortIcon field="website"></p-sortIcon></th>
                        <th pSortableColumn="vip">VIP <p-sortIcon field="vip"></p-sortIcon></th>
                        <th>Action</th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-entreprise let-expanded="expanded">
                    <tr>
                        <td>
                            <button type="button" pButton pRipple 
                                [pRowToggler]="entreprise" 
                                class="p-button-text p-button-rounded p-button-plain" 
                                [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"
                                style="background-color:white; color: green; border: 0px"></button>
                        </td>
                        <td>{{ entreprise.r_sociale }}</td>
                        <td>{{ entreprise.fm_juridique }}</td>
                        <td>{{ entreprise.siret }}</td>
                        <td>{{ entreprise.website }}</td>
                        <td>{{ entreprise.vip }}</td>
                        <td><i style="margin-left: 2%;" 
                                class="pi pi-pencil"
                                (click)="resetForms(); showFormUpdateEntreprise = true; showFormAddEntreprise = false; idEntrepriseToUpdate = entreprise._id; onGetbyId();"></i></td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="rowexpansion" let-entreprise>
                    <tr>
                        <td colspan="7">
                            <p-fieldset legend="Informations supplementaires">
                                <div class="p-grid ui-fluid">
                                    
                                    <div class="ui-g-4 ui-md-4">
                                        <div class="ui-g-6 ui-md-6">
                                            <b style="text-align:left !important;">Type d'entreprise:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6">
                                            {{ entreprise.type_ent }}
                                        </div>
                                    </div>

                                    <div class="ui-g-4 ui-md-4">
                                        <div class="ui-g-6 ui-md-6">
                                            <b style="text-align:left !important;">Interne:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6" *ngIf="entreprise.isInterne">
                                            <span>Interne</span>
                                        </div>
                                        <div class="ui-g-6 ui-md-6" *ngIf="!entreprise.isInterne">
                                            <span>Externe</span>
                                        </div>
                                    </div>

                                    <div class="ui-g-4 ui-md-4">
                                        <div class="ui-g-6 ui-md-6">
                                            <b style="text-align:left !important;">Code APE NAF:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6">
                                            {{ entreprise.code_ape_naf }}
                                        </div>
                                    </div>

                                    <div class="ui-g-4 ui-md-4">
                                        <div class="ui-g-6 ui-md-6">
                                            <b style="text-align:left !important;">Numéro TVA:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6">
                                            {{ entreprise.num_tva }}
                                        </div>
                                    </div>

                                    <div class="ui-g-4 ui-md-4">
                                        <div class="ui-g-6 ui-md-6">
                                            <b style="text-align:left !important;">Nom contact:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6">
                                            {{ entreprise.nom_contact }}
                                        </div>
                                    </div>

                                    <div class="ui-g-4 ui-md-4">
                                        <div class="ui-g-6 ui-md-6">
                                            <b style="text-align:left !important;">Prénom contact:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6">
                                            {{ entreprise.prenom_contact }}
                                        </div>
                                    </div>

                                    <div class="ui-g-4 ui-md-4">
                                        <div class="ui-g-6 ui-md-6">
                                            <b style="text-align:left !important;">Fonction contact:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6">
                                            {{ entreprise.fc_contact }}
                                        </div>
                                    </div>

                                    <div class="ui-g-4 ui-md-4">
                                        <div class="ui-g-6 ui-md-6">
                                            <b style="text-align:left !important;">Email contact:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6">
                                            {{ entreprise.email_contact }}
                                        </div>
                                    </div>

                                    <div class="ui-g-4 ui-md-4">
                                        <div class="ui-g-6 ui-md-6">
                                            <b style="text-align:left !important;">Numéro de téléphone contact:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6">
                                            {{ entreprise.phone_contact }}
                                        </div>
                                    </div>

                                    <div class="ui-g-4 ui-md-4">
                                        <div class="ui-g-6 ui-md-6">
                                            <b style="text-align:left !important;">Nom contact sécondaire:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6">
                                            {{ entreprise.nom_contact_2nd }}
                                        </div>
                                    </div>

                                    <div class="ui-g-4 ui-md-4">
                                        <div class="ui-g-6 ui-md-6">
                                            <b style="text-align:left !important;">Prénom contact sécondaire:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6">
                                            {{ entreprise.prenom_contact_2nd }}
                                        </div>
                                    </div>

                                    <div class="ui-g-4 ui-md-4">
                                        <div class="ui-g-6 ui-md-6">
                                            <b style="text-align:left !important;">Fonction contact sécondaire:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6">
                                            {{ entreprise.fc_contact_2nd }}
                                        </div>
                                    </div>

                                    <div class="ui-g-4 ui-md-4">
                                        <div class="ui-g-6 ui-md-6">
                                            <b style="text-align:left !important;">Email contact sécondaire:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6">
                                            {{ entreprise.email_contact_2nd }}
                                        </div>
                                    </div>

                                    <div class="ui-g-4 ui-md-4">
                                        <div class="ui-g-6 ui-md-6">
                                            <b style="text-align:left !important;">Numéro de téléphone contact sécondaire:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6">
                                            {{ entreprise.phone_contact_2nd }}
                                        </div>
                                    </div>

                                    <div class="ui-g-4 ui-md-4">
                                        <div class="ui-g-6 ui-md-6">
                                            <b style="text-align:left !important;">Financeur:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6">
                                            {{ entreprise.financeur }}
                                        </div>
                                    </div>

                                    <div class="ui-g-6 ui-md-6">
                                        <div class="ui-g-6 ui-md-6">
                                            <b style="text-align:left !important;">Pays:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6">
                                            {{ entreprise.pays_adresse }}
                                        </div>
                                    </div>

                                    <div class="ui-g-6 ui-md-6">
                                        <div class="ui-g-6 ui-md-6">
                                            <b style="text-align:left !important;">Ville:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6">
                                            {{ entreprise.ville_adresse }}
                                        </div>
                                    </div>

                                    <div class="ui-g-4 ui-md-4">
                                        <div class="ui-g-6 ui-md-6">
                                            <b style="text-align:left !important;">Nom de la rue:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6">
                                            {{ entreprise.rue_adresse }}
                                        </div>
                                    </div>

                                    <div class="ui-g-4 ui-md-4">
                                        <div class="ui-g-6 ui-md-6">
                                            <b style="text-align:left !important;">Numéro de la rue:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6">
                                            {{ entreprise.numero_adresse }}
                                        </div>
                                    </div>

                                    <div class="ui-g-4 ui-md-4">
                                        <div class="ui-g-6 ui-md-6">
                                            <b style="text-align:left !important;">Code postal:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6">
                                            {{ entreprise.postal_adresse }}
                                        </div>
                                    </div>

                                    <div class="ui-g-4 ui-md-4">
                                        <div class="ui-g-6 ui-md-6">
                                            <b style="text-align:left !important;">Email de l'entreprise:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6">
                                            {{ entreprise.email }}
                                        </div>
                                    </div>

                                    <div class="ui-g-4 ui-md-4">
                                        <div class="ui-g-6 ui-md-6">
                                            <b style="text-align:left !important;">Numéro de téléphone de l'entreprise:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6">
                                            {{ entreprise.phone }}
                                        </div>
                                    </div>

                                    <div class="ui-g-4 ui-md-4">
                                        <div class="ui-g-6 ui-md-6">
                                            <b style="text-align:left !important;">Site internet de l'entreprise:</b>
                                        </div>
                                        <div class="ui-g-6 ui-md-6">
                                            {{ entreprise.website }}
                                        </div>
                                    </div>
                                    
                                </div>
                            </p-fieldset>
                        </td>
                    </tr>
                </ng-template>
            </p-table>

        </div>
    </div>
</div>