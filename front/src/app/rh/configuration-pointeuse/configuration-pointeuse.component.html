<div class="grid">
    <div class="col-12" *ngIf="showAdd">
        <div class="card">
            <i aria-hidden="true" class="pi pi-times-circle" style="float:right; color: red; cursor: pointer;"
                (click)="showAdd = false;">
            </i>
            <h4 style="text-align: center;">Configurer une pointeuse</h4>
            <div style="text-align: center;">
                <small>Tous les champs marqués d'un astérisque <span style="color: red;"> * </span> sont
                    obligatoires</small><br>
            </div>
            <form class="p-fluid p-formgrid grid" [formGroup]="addForm" (ngSubmit)="onAdd()">
                <div class="field col-12 md:col-6">
                    <label>Numéro de série<span style="color: red;"> * </span></label>
                    <p-dropdown placeholder="Choisissez un numéro de série" filter="true"
                        formControlName="serial_number" [options]="serialNumberList" autoWidth="false"
                        [style]="{'width':'100%'}">
                    </p-dropdown>
                </div>
                <div class="field col-12 md:col-6">
                    <label>Localisation<span style="color: red;"> * </span></label>
                    <p-dropdown placeholder="Choisissez un site" filter="true" formControlName="localisation"
                        [options]="localisationDropdown" autoWidth="false" [style]="{'width':'100%'}">
                    </p-dropdown>
                </div>
                <div class="field col-12">
                    <label>Type de pointage<span style="color: red;"> * </span></label>
                    <p-multiSelect placeholder="Choisissez un type de pointage" filter="true"
                        formControlName="pointageType" [options]="typePointageDropdown" autoWidth="false"
                        [style]="{'width':'100%'}">
                    </p-multiSelect>
                </div>

                <div style="justify-content: right;">
                    <button pButton label="Ajouter une pointeuse" [disabled]="addForm.invalid" type="submit"></button>
                </div>
            </form>
        </div>
    </div>
    <div class="col-12" *ngIf="showUpdate">
        <div class="card">
            <i aria-hidden="true" class="pi pi-times-circle" style="float:right; color: red; cursor: pointer;"
                (click)="showUpdate = null;">
            </i>
            <h4 style="text-align: center;">Reconfigurer une pointeuse</h4>
            <div style="text-align: center;">
                <small>Tous les champs marqués d'un astérisque <span style="color: red;"> * </span> sont
                    obligatoires</small><br>
            </div>
            <form class="p-fluid p-formgrid grid" [formGroup]="updateForm" (ngSubmit)="onUpdate()">
                <div class="field col-12 md:col-6">
                    <label>Numéro de série<span style="color: red;"> * </span></label>
                    <p-dropdown placeholder="Choisissez un numéro de série" filter="true"
                        formControlName="serial_number" [options]="serialNumberList" autoWidth="false"
                        [style]="{'width':'100%'}">
                    </p-dropdown>
                </div>
                <div class="field col-12 md:col-6">
                    <label>Localisation<span style="color: red;"> * </span></label>
                    <p-dropdown placeholder="Choisissez un site" filter="true" formControlName="localisation"
                        [options]="localisationDropdown" autoWidth="false" [style]="{'width':'100%'}">
                    </p-dropdown>
                </div>
                <div class="field col-12">
                    <label>Type de pointage<span style="color: red;"> * </span></label>
                    <p-multiSelect placeholder="Choisissez un type de pointage" filter="true"
                        formControlName="pointageType" [options]="typePointageDropdown" autoWidth="false"
                        [style]="{'width':'100%'}">
                    </p-multiSelect>
                </div>

                <div style="justify-content: right;">
                    <button pButton label="Modifier la pointeuse" [disabled]="addForm.invalid" type="submit"></button>
                </div>
            </form>
        </div>
    </div>
    <div class="col-12">
        <div class="card">
            <button pButton pRipple label="Configurer une nouvelle pointeuse" class="mr-2 mb-2" style="float: right;"
                (click)="showAdd = true;scrollToTop()"></button>
            <h5>Liste des pointeuse</h5>

            <p-toast></p-toast>
            <p-table #dt1 dataKey="_id" [rows]="8" [rowHover]="true" [paginator]="true" [value]="pointeuses"
                [paginator]="true" [pageLinks]="5" selectionMode="single"
                [globalFilterFields]="['ID', 'serial_number', 'localisation','ip','name']" responsiveLayout="scroll"
                styleClass="p-datatable-gridlines">
                <ng-template pTemplate="caption">
                    <span class="p-input-icon-left mb-2">
                        <i class="pi pi-search"></i>
                        <input pInputText type="text" #filter
                            (input)="dt1.filterGlobal($event.target.value, 'contains')" placeholder="Recherche"
                            class="w-full" />
                    </span>
                </ng-template>
                <ng-template pTemplate="header">
                    <tr>
                        <th pSortableColumn="_id" scope="col" style="text-align: center;">
                            ID Pointeuse <p-sortIcon field="_id"></p-sortIcon>
                        </th>
                        <th pSortableColumn="serial_number" scope="col" style="text-align: center;">
                            Numéro de série <p-sortIcon field="serial_number"></p-sortIcon>
                        </th>
                        <th pSortableColumn="localisation" scope="col" style="text-align: center;">
                            Localisation <p-sortIcon field="localisation"></p-sortIcon>
                        </th>
                        <th>
                            Type de Pointage disponible
                        </th>
                        <th pSortableColumn="nb_users_register" scope="col" style="text-align: center;">
                            Nombre des utilisateurs enregistrées <p-sortIcon field="nb_users_register"></p-sortIcon>
                        </th>
                        <th>
                            Action
                        </th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-machine>
                    <tr>
                        <td>
                            {{machine._id | slice: 0:20 }}...
                        </td>
                        <td>
                            {{machine.serial_number}}
                        </td>
                        <td>
                            {{machine.localisation}}
                        </td>
                        <td>
                            {{machine.pointageType}}
                        </td>
                        <td>
                            En dévéloppement
                        </td>
                        <td>
                            <i pTooltip="Voir des informations supplémentaire" tooltipPosition="bottom"
                                class="pi pi-cog mr-2" (click)="seePopUp(machine);scrollToTop()" aria-hidden="true"></i>
                            <i pTooltip="Modifier" tooltipPosition="bottom" class="pi pi-cog mr-2"
                                (click)="initUpdate(machine);scrollToTop()" aria-hidden="true"></i>
                            <i pTooltip="Supprimer" tooltipPosition="bottom" class="pi pi-trash mr-2"
                                (click)="onDelete(machine)" aria-hidden="true"></i>
                            <i pTooltip="Voir la liste des utilisateurs" tooltipPosition="bottom" class="pi pi-cog mr-2"
                                (click)="seeUsers(machine);scrollToTop()" aria-hidden="true"></i>
                        </td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
    </div>
</div>