<!-- Formulaire d'ajout d'une nouvelle équipe-->
<div class="grid" *ngIf="showFormAddTeam">
    <div class="col-12">
        <div class="card">
            <i class="pi pi-times-circle"
					style="float:right; margin-right: 30px; font-size: 20px; color: red; cursor: pointer;"
					pTooltip="Fermer" (click)="showFormAddTeam = false" aria-hidden="true"></i>
            <h4 style="text-align: center;">Ajouter une équipe</h4>
            <form class="p-fluid" [formGroup]="formAddTeam" (ngSubmit)="onAddTeam()">
                <div class="p-formgrid grid">
                    <div class="field col-6">
                        <label htmlFor="libelle">Libelle</label>
                        <input pInputText id="libelle" type="text" formControlName="libelle" placeholder="Par exemple, Inted Group Support" />
                    </div>
                    <div class="field col-6">
                        <label htmlFor="abbreviation">Abbréviation</label>
                        <input pInputText id="abbreviation" type="text" formControlName="abbreviation" placeholder="IGS" />
                    </div>
                    <div>
						<button pButton type="submit" label="Ajouter l'équipe" icon="pi pi-plus"></button>
					</div>
                </div>
            </form>         
        </div>
    </div>
</div>

<!--Formualaire d'ajout d'un salarié à une équipe-->
<div class="grid" *ngIf="showFormAddSalaries">
    <div class="col-12">
        <div class="card">
            <i class="pi pi-times-circle"
					style="float:right; margin-right: 30px; font-size: 20px; color: red; cursor: pointer;"
					pTooltip="Fermer" (click)="showFormAddSalaries = false" aria-hidden="true"></i>
            <h4 style="text-align: center;">Ajouter à l'équipe :</h4>
            <form class="p-fluid" [formGroup]="formAddTeam" (ngSubmit)="onAddTeam()">
                <div class="p-formgrid grid">
                    <div class="field col-12">
						<label htmlFor="attribuateTo">Sélectionner les membres à ajouter à l'équipe</label>
						<p-multiSelect [options]="dropdownUser" [(ngModel)]="selectedMulti" defaultLabel="Selectionner les personnes que vous voulez ajouter à l'équipe" optionLabel="label" class="multiselect-custom">
							<ng-template let-value pTemplate="selectedItems">
								<div class="country-item country-item-value inline-flex align-items-center py-1 px-2 bg-primary text-primary border-round mr-2" *ngFor="let option of selectedMulti">
									<div>{{option.label}}</div>
								</div>
								<div *ngIf="!selectedMulti || selectedMulti.length === 0" class="country-placeholder">
									Selectionner les personnes que vous voulez ajouter à l'équipe
								</div>
							</ng-template>
							<ng-template let-user pTemplate="item">
								<div class="flex align-items-center country-item">
									<div>{{user.label}}</div>
								</div>
							</ng-template>
						</p-multiSelect>
					</div>
                    <div>
						<button pButton type="submit" label="Ajouter à l'équipe" icon="pi pi-plus"></button>
					</div>
                </div>
            </form>         
        </div>
    </div>
</div>

<!-- Tableau d'affichage des équipes-->
<div class="grid">
    <div class="col-12">
        <div class="card">
            <button pButton label="Nouvelle équipe" icon="pi pi-plus" style="float: right;" (click)="showFormAddTeam = true"></button>
            <h4>Équipes</h4>
            <p-table #dt1 [value]="teams" dataKey="_id" editMode="row"
            [rows]="5" [rowHover]="true" [paginator]="true"
            [globalFilterFields]="['libelle','abbreviation']"
            responsiveLayout="scroll" styleClass="p-datatable-gridlines">

       <ng-template pTemplate="caption">
           <div class="flex justify-content-between flex-column sm:flex-row">
               <span class="p-input-icon-left mb-2">
                   <i class="pi pi-search"></i>
                   <input pInputText type="text" #filter
                       (input)="dt1.filterGlobal($event.target.value, 'contains')" placeholder="Recherche"
                       class="w-full" />
               </span>
           </div>
       </ng-template>

       <ng-template pTemplate="header">
           <tr>
               <th>Libelle</th>
               <th>Abbréviation</th>
               <th pSortableColumn="action" style="text-align:center">Action</th>
           </tr>
       </ng-template>
       <ng-template pTemplate="body" let-team let-editing="editing" let-ri="rowIndex">
           <tr [pEditableRow]="team">
               <td>
                   <p-cellEditor>
                       <ng-template pTemplate="input">
                           <input pInputText type="text" [(ngModel)]="team.libelle">
                       </ng-template>
                       <ng-template pTemplate="output">
                        {{team.libelle}}
                       </ng-template>
                   </p-cellEditor>
               </td>
               <td>
                <p-cellEditor>
                    <ng-template pTemplate="input">
                        <input pInputText type="text" [(ngModel)]="team.abbreviation">
                    </ng-template>
                    <ng-template pTemplate="output">
                     {{team.abbreviation}}
                    </ng-template>
                </p-cellEditor>
               </td>
               <td>
                   <div class="flex align-items-center justify-content-center gap-2">
                        <button *ngIf="!editing" pButton pRipple type="button" icon="pi pi-list" 
                            class="p-button-rounded p-button-text" (click)="showTableOfSalaries = true"></button>        
                        <button *ngIf="!editing" pButton pRipple type="button" icon="pi pi-user-plus" 
                            class="p-button-rounded p-button-text p-button-success mr-2" (click)="showFormAddSalaries = true">  </button>        
                        <button *ngIf="!editing" pButton pRipple type="button" pInitEditableRow
                           icon="pi pi-pencil" (click)="onRowEditInit(team)"
                           class="p-button-rounded p-button-text p-button-danger"></button>
                        <button *ngIf="editing" pButton pRipple type="button" pSaveEditableRow
                           icon="pi pi-check" (click)="onRowEditSave(team)"
                           class="p-button-rounded p-button-text p-button-success mr-2"></button>
                        <button *ngIf="editing" pButton pRipple type="button" pCancelEditableRow
                           icon="pi pi-times" (click)="onRowEditCancel(team)"
                           class="p-button-rounded p-button-text p-button-danger"></button> 
                   </div>
               </td>
           </tr>
       </ng-template>
   </p-table>
        </div>
    </div>
</div>

<!-- Affichage de la liste des salariés dans une équipe selectionner-->
<div class="grid" *ngIf="showTableOfSalaries">
    <div class="col-12">
        <div class="card">
            <i class="pi pi-times-circle"
                style="float:right; margin-right: 30px; font-size: 20px; color: red; cursor: pointer;"
                pTooltip="Fermer" (click)="showTableOfSalaries = false" aria-hidden="true"></i>
            <h5>Liste des salariés de l'équipe :</h5>
        </div>
    </div>
</div>