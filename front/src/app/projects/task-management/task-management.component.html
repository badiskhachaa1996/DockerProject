<p-toast></p-toast>
<!-- Affichage des tâches du projet -->
<!-- <div class="grid">
	<div class="col-12">
		<div class="card">
			<h3>Tâches du projet</h3>
			
			<div class="flex align-items- justify-content-center flex-wrap card-container blue-container">
				<div class="md:col-4">
					<p-card header="Simple Card" [style]="{'width': '25rem', 'margin-bottom': '2em'}">
						<ng-template pTemplate="header">
							<img alt="Card" src="assets/showcase/images/usercard.png">
						</ng-template>
						<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Inventore sed consequuntur error repudiandae numquam deserunt
							quisquam repellat libero asperiores earum nam nobis, culpa ratione quam perferendis esse, cupiditate neque quas!</p>
					</p-card>
				</div>				
			</div>			
		</div>
	</div>
</div> -->


<!-- Formulaire d'ajout d'un nouveau projet -->
<div class="col-12" *ngIf="showFormAddProject">
	<div class="card">
		<i class="pi pi-times-circle"
				style="float:right; margin-right: 30px; font-size: 20px; color: red; cursor: pointer;"
				pTooltip="Fermer" (click)="showFormAddProject = false" aria-hidden="true"> </i>

		<h3>Nouveau projet</h3>
		<form class="p-fluid" [formGroup]="formAddProject" (ngSubmit)="onAddProject()">
			<div class="p-formgrid grid">
				<div class="field col-12">
					<label htmlFor="libelle">Libelle</label>
					<input pInputText id="libelle" type="text" formControlName="libelle" placeholder="Titre du projet"/>
				</div>
				
				<div>
					<button pButton type="submit" label="Ajouter le projet" icon="pi pi-plus" [disabled]="formAddProject.invalid"></button>
				</div>
			</div>
		</form>

	</div>
</div>


<!-- Affichage des projets -->
<div class="grid">
	<div class="col-12">
		<div class="card">
			<button pButton label="Nouveau projet" icon="pi pi-plus" style="float: right;" (click)="showFormAddProject = true"></button>
			<h5>Projets</h5>
			<p-table #dt1 [value]="projects" dataKey="_id" editMode="row" [tableStyle]="{'min-width': '50rem'}"
					 [rows]="10" [rowHover]="true" [paginator]="true"
					 [globalFilterFields]="['libelle','percent','creator_id?.lastname','creator_id?.firstname', 'creator_id?.email', 'creator_id?.email_perso']"
					 responsiveLayout="scroll">

				<ng-template pTemplate="caption">
					<div class="flex justify-content-between flex-column sm:flex-row">
						<span class="p-input-icon-left mb-2">
							<i class="pi pi-search"></i>
							<input pInputText type="text" #filter
								(input)="dt1.filterGlobal($event.target.value, 'contains')" placeholder="Recherche"
								class="w-full" />
						</span>
					</div>
				</ng-template>

				<ng-template pTemplate="header">
					<tr>
						<th style="width:20%">Libelle</th>
						<th style="width:20%">Avancement</th>
						<th style="width:20%">Créateur</th>
						<th style="width:20%">Date de création</th>
						<th style="width:20%"></th>
					</tr>
				</ng-template>
				<ng-template pTemplate="body" let-project let-editing="editing" let-ri="rowIndex">
					<tr [pEditableRow]="project">
						<td>
							<p-cellEditor>
								<ng-template pTemplate="input">
									<input pInputText type="text" [(ngModel)]="project.libelle">
								</ng-template>
								<ng-template pTemplate="output">
									{{project.libelle}}
								</ng-template>
							</p-cellEditor>
						</td>
						<td>
							{{project.percent}}
						</td>
						<td>
							{{ project.creator_id?.firstname  }} {{ project.creator_id?.lastname  }}
						</td>
						<td style="min-width: 12rem;">
							{{ project.created_at | date: 'dd/MM/YYYY HH:mm' }}
						</td>
						<td>
							<div class="flex align-items-center justify-content-center gap-2">
								<button *ngIf="!editing" pButton pRipple type="button" pInitEditableRow
									icon="pi pi-pencil" (click)="onRowEditInit(product)"
									class="p-button-rounded p-button-text"></button>
								<button *ngIf="editing" pButton pRipple type="button" pSaveEditableRow
									icon="pi pi-check" (click)="onRowEditSave(product)"
									class="p-button-rounded p-button-text p-button-success mr-2"></button>
								<button *ngIf="editing" pButton pRipple type="button" pCancelEditableRow
									icon="pi pi-times" (click)="onRowEditCancel(product, ri)"
									class="p-button-rounded p-button-text p-button-danger"></button>
							</div>
						</td>
					</tr>
				</ng-template>
			</p-table>
		</div>
	</div>
</div>




<!-- <div class="grid">
	<div class="col-12">
		<div class="card">
			<h5>Projets</h5>
			<p-table #dt1 [value]="projects" dataKey="_id" [rows]="10" [loading]="loading" [rowHover]="true"
				styleClass="p-datatable-gridlines" [paginator]="true"
				[globalFilterFields]="['libelle','percent','creator_id.lastname','creator_id.firstname', 'creator_id.email', 'creator_id.email_perso']"
				responsiveLayout="scroll">
				<ng-template pTemplate="caption">
					<div class="flex justify-content-between flex-column sm:flex-row">
						<button pButton label="Clear" class="p-button-outlined mb-2" icon="pi pi-filter-slash"
							(click)="clear(dt1)"></button>
						<span class="p-input-icon-left mb-2">
							<i class="pi pi-search"></i>
							<input pInputText type="text" #filter
								(input)="dt1.filterGlobal($event.target.value, 'contains')" placeholder="Search Keyword"
								class="w-full" />
						</span>
					</div>
				</ng-template>
				<ng-template pTemplate="header">
					<tr>
						<th>
							<div class="flex justify-content-between align-items-center">
								Libelle
							</div>
						</th>
						<th>
							<div class="flex justify-content-between align-items-center">
								Avancement
							</div>
						</th>
						<th>
							<div class="flex justify-content-between align-items-center">
								Créateur
							</div>
						</th>
						<th>
							<div class="flex justify-content-between align-items-center">
								Date de création
							</div>
						</th>
					</tr>
				</ng-template>
				<ng-template pTemplate="body" let-project>
					<tr>
						<td style="min-width: 12rem;">
							{{ project.libelle }}
						</td>
						<td style="min-width: 12rem;">
							{{ project.percent }}
						</td>
						<td style="min-width: 12rem;">
							{{ project.creator_id.firstname | uppercase }} {{ project.creator_id.lastname | titlecase }}
						</td>
						<td style="min-width: 12rem;">
							{{ project.created_at | date: 'short' }}
						</td>
						<td class="text-center" style="min-width: 8rem;">
							<i class="pi pi-pencil" title="Modifier"></i>
						</td>
					</tr>
				</ng-template>
				<ng-template pTemplate="emptymessage">
					<tr>
						<td colspan="7">No customers found.</td>
					</tr>
				</ng-template>
				<ng-template pTemplate="loadingbody">
					<tr>
						<td colspan="7">Loading customers data. Please wait.</td>
					</tr>
				</ng-template>
			</p-table>
		</div>

	</div>
</div> -->