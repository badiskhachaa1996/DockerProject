<p-toast></p-toast>

<div class="grid">
    <div class="grid card col-12 ">
        <div class="col-12 md:col-6">
            <h4>Récapitulatif sur l'assiduité de {{ Etudiant_userdata?.civilite == 'Monsieur' ? 'M.': 'Mme.' }} {{Etudiant_userdata?.firstname | titlecase }} {{ Etudiant_userdata?.lastname | uppercase }}</h4>
            <p-chart #chart type="bar" [data]="barDataAJ" [options]="barOptions" [style]="{'width': 'full-vw'}">
            </p-chart>
        </div>
        <p-divider class="col-1" layout="vertical"></p-divider>
        <div class="col-12 md:col-5">
            <p-chart #chart2 type="pie" [data]="barDataHorAJ" [options]="horizontalOptions" [style]="{'width': 'full-vw'}">
            </p-chart>

        </div>
        <div class="col-12" *ngIf="pourcentageAssiduite<80">
            <h3>Pourcentage d'assiduité: </h3>
            <p-progressBar class="customProgress" [value]="pourcentageAssiduite">
            </p-progressBar>
        </div>
        <div class="col-12" *ngIf="pourcentageAssiduite>=80">
            <h3>Pourcentage d'assiduité: </h3>
            <p-progressBar class="customProgress2" [value]="pourcentageAssiduite">
            </p-progressBar>
        </div>

    </div>
    <div class="card col-12">
        <p-toast></p-toast>
        <h4>Listes des présences</h4>
        <p-table #dt1 [value]="AssiduiteListe" dataKey="_id" responsiveLayout="scroll" [globalFilterFields]="[]"
            [rows]="10" [pageLinks]="5" [paginator]="true" [totalRecords]="AssiduiteListe?.length">
            <ng-template pTemplate="header">
                <tr>
                    <th>Module </th>
                    <th pSortableColumn="_id">Date de la seance <p-sortIcon field="_id"></p-sortIcon>
                    </th>
                    <th pSortableColumn="seance_id">Seance<p-sortIcon field="seance_id">
                        </p-sortIcon>
                    </th>
                    <th>Présence</th>
                    <th>Heure d'arrivé</th>
                    <th>Heure déconnexion</th>
                    <th>Justificatif </th>
                    <th>Action </th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-Assiduit>
                <tr>
                    <td>{{matiereDic[Assiduit.seance_id.matiere_id]?.abbrv}}</td>

                    <td>
                        {{ Assiduit.seance_id.date_debut | date:'dd/MM/yyyy HH:mm'}} </td>
                    <td> {{ Assiduit.seance_id.libelle}}</td>

                    <td *ngIf="Assiduit.isPresent">
                        <p-tag class="p-tag-icon" icon="pi pi-plus" severity="success" value="Present"
                            icon="pi pi-check"></p-tag>
                    </td>
                    <td *ngIf="!Assiduit.isPresent">
                        <p-tag class="p-tag-icon" *ngIf="!Assiduit.justificatif" severity="danger" value="Absent"
                            icon="pi pi-exclamation-circle"></p-tag>
                        <p-tag class="p-tag-icon" *ngIf="Assiduit.justificatif" severity="warning" value="Absent"
                            icon="pi pi-exclamation-circle"></p-tag>
                    </td>

                    <td>{{ (Assiduit.date_signature) ? (Assiduit.date_signature | date : "HH:mm":'locale' ) :'--' }}
                    </td>
                    <td *ngIf="Assiduit.date_signature">{{ Assiduit.seance_id.date_fin | date:'HH:mm'}}</td>
                    <td *ngIf="!Assiduit.date_signature">--</td>
                    <td *ngIf="Assiduit.isPresent">--</td>
                    <td *ngIf="!Assiduit.isPresent && Assiduit.justificatif">
                        <p-tag value="Justifié" icon="pi pi-check" class="p-tag-icon" severity="success"></p-tag>
                    </td>
                    <td *ngIf="!Assiduit.isPresent && !Assiduit.justificatif">
                        <p-tag class="p-tag-icon" value="Non Justifié" icon="pi pi-exclamation-circle"
                            severity="danger"></p-tag>
                    </td>
                    <td>

                        <i *ngIf="Assiduit.justificatif" pTooltip="Voir le justificatif" tooltipPosition="bottom"
                            class="pi pi-file" style="margin-left: 2%;" (click)="VoirJustificatif(Assiduit._id)"
                            aria-hidden="true"></i>
                    </td>
                </tr>
            </ng-template>

        </p-table>
    </div>

</div>