<div class="grid">
    <div class="col-12">
        <p-dialog header="Merci de suivre ces instructions avant d'ajouter une nouvelle séance" [(visible)]="display"
            modal="modal" showEffect="fade" [style]="{width: '30vw'}" [breakpoints]="{'960px': '75vw'}">
            <p class="line-height-3 m-0">
                Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et
                dolore magna aliqua. Ut enim ad minim veniam,
                quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor
                in reprehenderit
                in voluptate velit esse cillum dolore eu fugiat nulla pariatur.
                Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est
                laborum.
            </p>
            <ng-template pTemplate="footer">
                <button pButton icon="pi pi-check" (click)="display=false" label="Ok"
                    class="p-button-outlined"></button>
            </ng-template>
        </p-dialog>
        <div class="grid">
            <div class="col-12">
                <button (click)="display=true" pButton icon="pi pi-info-circle" label="Informations"
                    style="width:auto;"></button>
            </div>
        </div>
    </div>

    <div class="col-12">
        <div class="card">
            <h4 style="text-align: center;">Ajouter un étudiant </h4>
            <div style="text-align: center;">
                <small style="text-align: center; font-size: 12px;">Tous les champs marqués d'un astérix <span
                        style="color: red;"> * </span> sont obligatoires</small>
            </div>
            <br>
            <form class="p-fluid p-formgrid grid" [formGroup]="formAddEtudiant" (ngSubmit)="onAddEtudiant()">
                <div class="field col-5 md:col-4">
                    <label For="civilite">Civilité<span style="color: red;"> * </span></label>
                    <p-dropdown [options]="civiliteList" optionLabel="value" optionDisabled="actif"
                        formControlName="civilite"></p-dropdown>
                </div>

                <div class="field col-12 md:col-4">
                    <label For="nom">Nom <span style="color: red;"> * </span></label>
                    <input pInputText id="nom" type="text" placeholder="Entrez votre nom" formControlName="lastname" />

                    <div *ngIf="lastname.invalid && (lastname.touched || lastname.dirty)">
                        <span  style="color: red;" class="error" *ngIf="lastname.errors?.required" style="color: red;">* Le nom est obligatoire </span>
                        <span *ngIf="lastname.errors?.pattern" style="color: red;">Le nom n'est pas dans le bon format</span>
                    </div>
                </div>

                <div class="field col-12 md:col-4">
                    <label For="prenom">Prénom <span style="color: red;"> * </span></label>
                    <input pInputText id="prenom" type="text" placeholder="Entrez votre prénom"
                        formControlName="firstname" />

                    <div *ngIf="firstname.invalid && (firstname.touched || firstname.dirty)">
                        <span  style="color: red;" class="error" *ngIf="firstname.errors?.required" style="color: red;">* Le prénom est obligatoire </span>
                        <span *ngIf="firstname.errors?.pattern" style="color: red;"> Le prénom n'est pas dans le bon format </span>
                    </div>
                </div>

                <div class="field col-4 md:col-2">
                    <label For="indicatif">Indicatif <span style="color: red;"> * </span></label>
                    <input pInputText id="indicatif" type="number" placeholder="+33" formControlName="indicatif" />

                    <div *ngIf="indicatif.invalid && (indicatif.touched || indicatif.dirty)">
                        <span  style="color: red;" class="error" *ngIf="indicatif.errors?.required" style="color: red;">* L'indicatif téléphone est obligatoire </span>
                    </div>
                </div>

                <div class="field col-8 md:col-4">
                    <label For="telephone">Numéro de téléphone <span style="color: red;"> * </span></label>
                    <input pInputText id="telephone" type="text" placeholder="Entrez votre numéro de téléphone"
                        formControlName="phone" />

                    <div *ngIf="phone.invalid && (phone.touched || phone.dirty)">
                        <span  style="color: red;" class="error" *ngIf="phone.errors?.required" style="color: red;">* Le numéro de téléphone est obligatoire </span>
                        <span *ngIf="phone.errors?.pattern" style="color: red;"> Le numéro de téléphone n'est pas dans le bon format</span>
                    </div>
                </div>

                <div class="field col-12 md:col-6">
                    <label For="mail">Adresse email <span style="color: red;"> * </span></label>
                    <input pInputText id="mail" type="email" placeholder="Entrez votre adresse mail (@estya.com)"
                        formControlName="email" />

                    <div *ngIf="email.invalid && (email.touched || email.dirty)">
                        <span  style="color: red;" class="error" *ngIf="email.errors?.required" style="color: red;">* L'email est obligatoire </span>
                        <span *ngIf="email.errors?.pattern" style="color: red;"> L'email' n'est pas dans le bon format, 'xxx@estya.com'</span>
                    </div>
                </div>

                <div class="field col-12 md:col-6">
                    <label For="nom_rue">Nom de la rue <span style="color: red;"> * </span></label>
                    <input pInputText id="nom_rue" type="text" placeholder="Nom de votre rue"
                        formControlName="rue_adresse" />

                    <div *ngIf="rue_adresse.invalid && (rue_adresse.touched || rue_adresse.dirty)">
                        <span *ngIf="rue_adresse.errors?.pattern" style="color: red;">
                            Le nom de la rue n'est pas dans le bon format
                        </span>
                    </div>
                </div>

                <div class="field col-6 md:col-3">
                    <label For="numero_rue">Numéro de la rue <span style="color: red;"> * </span></label>
                    <input pInputText id="numero_rue" type="text" placeholder="Numéro de votre rue"
                        formControlName="numero_adresse" />
                </div>

                <div class="field col-6 md:col-3">
                    <label For="code_postale">Code postale<span style="color: red;"> * </span></label>
                    <input pInputText id="code_postale" type="text" placeholder="Code postale"
                        formControlName="postal_adresse" />
                </div>

                <div class="field col-12 md:col-6">
                    <label For="ville">Ville<span style="color: red;"> * </span></label>
                    <input pInputText id="ville" type="text" placeholder="Ville" formControlName="ville_adresse" />

                    <div *ngIf="ville_adresse.invalid && (ville_adresse.touched || ville_adresse.dirty)">
                        <span *ngIf="ville_adresse.errors?.pattern" style="color: red;">
                            Le nom de la ville n'est pas dans le bon format
                        </span>
                    </div>
                </div>

                <div class="field col-12 md:col-6">
                    <label For="ville">Pays<span style="color: red;"> * </span></label>
                    <p-dropdown [options]="paysList" optionLabel="value" optionDisabled="actif"
                        formControlName="pays_adresse"></p-dropdown>
                    <div *ngIf="pays_adresse.invalid && (pays_adresse.touched || pays_adresse.dirty)">
                        <span *ngIf="pays_adresse.errors?.pattern" style="color: red;">
                            Le nom du pays n'est pas dans le bon format
                        </span>
                    </div>
                </div>

                <div class="field col-12 md:col-6">
                    <label For="statut">Statut<span style="color: red;"> * </span></label>
                    <p-dropdown [options]="statutList" optionLabel="viewValue" optionDisabled="actif"
                        formControlName="statut"></p-dropdown>
                </div>

                <!-- liste à retirer car récupérer -->
                <div class="field col-12 md:col-6">
                    <label For="groupe">Groupe<span style="color: red;"> * </span></label>
                    <p-dropdown [options]="dropdownClasse" optionLabel="libelle" placeholder="Choissisez un groupe"
                        formControlName="classe_id" emptyFilterMessage="Pas de groupe trouvé" filterPlaceholder="Groupe"
                        filter="true">
                    </p-dropdown>
                </div>

                <div class="field col-12 md:col-6">
                    <label For="nationalite">Nationaltié<span style="color: red;"> * </span></label>
                    <p-dropdown formControlName="nationalite" [options]="nationList" optionLabel="viewValue"
                        emptyFilterMessage="Pas de nationalité trouvé" filterPlaceholder="Nationalité" filter="true">
                    </p-dropdown>
                </div>
                <div class="field col-12 md:col-6">
                    <label For="date_naissance">Date de naissance<span style="color: red;"> * </span></label>
                    <input formControlName="date_naissance" pInputText (change)="isMinorFC()" type="date" />
                </div>


                <div class="field col-12">
                    <label For="ville">Dernier diplome obtenu</label>
                    <input pInputText type="text" id="ville" placeholder="Licence en DEV WEB & WEB Mobile"
                        formControlName="dernier_diplome" />
                </div>

                <div class="field col-12 md:col-6">
                    <label For="sosemail">Email d'une personne en cas d'urgence</label>
                    <input pInputText type="email" id="sosemail" placeholder="email@gmail.com"
                        formControlName="sos_email" />
                </div>

                <div class="field col-12 md:col-6">
                    <label For="sostel">Téléphone d'une personne en cas d'urgence</label>
                    <input pInputText type="text" id="sostel" placeholder="+33 0601234589"
                        formControlName="sos_phone" />
                </div>

                <div class="field col-12">
                    <label>Code Etudiant:</label>
                    <div class="p-inputgroup">
                        <input type="text" formControlName="custom_id" pInputText placeholder="LNGX01">
                        <button type="button" pButton pRipple icon="pi pi-refresh" styleClass="p-button-warn"
                            (click)="generateCustomCode()">
                        </button>
                    </div>
                </div>

                <!-- Parcous Etudiant-->
                <div class="col-12 grid" *ngFor="let data of parcoursList; let i = index">
                    <!--<p style="font-style:italic">Payement n°{{i+1}}</p>-->
                    <div class="field col-12 md:col-5">
                        <label>Diplome du parcours:</label><br>
                        <input pInputText type="text" [(value)]="parcoursList[i]['diplome']" placeholder="BTS"
                            class="form-control">
                    </div>
                    <div class="field col-12 md:col-5">
                        <label>Date du parcours:</label><br>
                        <input type="date" [(value)]="parcoursList[i]['date']" pInputText>
                    </div>
                    <div class="field col-12 md:col-2">
                        <i class="pi pi-trash" (click)="onRemoveParcours(i)" aria-hidden="true"></i>
                    </div>
                </div>
                <div class="col-12">
                    <button type="button" (click)="onAddParcours()" pButton label="Ajouter un parcours"></button>
                </div>

                <div class="field col-12">
                    <label for="remarque">Remarque</label>
                    <textarea pInputTextarea formControlName="remarque" placeholder="Remarque"></textarea>
                </div>

                <div class="field col-12 md:col-6">
                    <label For="ine">Numéro INE</label>
                    <input pInputText type="text" id="ine" placeholder="1234567890G" formControlName="numero_INE" />
                </div>

                <div class="field col-12 md:col-6">
                    <label For="nir">Numéro NIR</label>
                    <input pInputText type="text" id="nir" placeholder="1 53 12 45 007 231 48"
                        formControlName="numero_NIR" />
                </div>


                <div class="grid field col-12" *ngIf="isMinorFC()">


                    <div class="field col-12 md:col-6">
                        <label For="nrl">Nom du représentant légal</label>
                        <input pInputText type="text" id="nrl" placeholder="Doe" formControlName="nom_rl" />
                    </div>

                    <div class="field col-12 md:col-6">
                        <label For="prl">Prénom du représentant légal</label>
                        <input pInputText type="text" id="prl" placeholder="John" formControlName="prenom_rl" />
                    </div>

                    <div class="field col-12">
                        <label For="erl">Email du représentant légal</label>
                        <input pInputText type="email" id="erl" placeholder="email@gmail.com"
                            formControlName="email_rl" />
                    </div>

                    <div class="field col-12">
                        <label For="erl">Adresse du représentant légal</label>
                        <textarea pInputTextarea placeholder="15 Rue du louvre 75001 Paris, France"
                            formControlName="adresse_rl" autoResize rows="3" cols="30"></textarea>
                    </div>

                </div>

                <div class="field col-12">
                    <p-selectButton [options]="[{label:'Initial',value:false},{label:'Alternant',value:true}]"
                        formControlName="isAlternant"></p-selectButton>
                </div>
                <div class="col-12" *ngIf="!formAddEtudiant.value.isAlternant">
                    <p-selectButton [options]="[{label:'Pas de stage',value:false},{label:'En stage',value:true}]"
                        formControlName="isOnStage" (onChange)="changestage()"></p-selectButton>


                </div>

                <div class="col-12" *ngIf="formAddEtudiant.value.isAlternant || formAddEtudiant.value.isOnStage ">
                    <div class="field col-12">
                        <label>Entreprise<span style="color: red;"> * </span></label>
                        <!-- <p-dropdown formControlName="entreprise_id" [options]="dropdownEntreprise" optionLabel="libelle"
                                    emptyFilterMessage="Pas d'entreprise trouvé" filterPlaceholder="Entreprise"
                                    filter="true">
                        </p-dropdown> -->
                        <input pInputText type="text" placeholder="Veuillez saisir le nom de l'entreprise"
                            formControlName="entreprise" />
                    </div>

                    <div class="field col-12">
                        <label For="tn">Nom du tuteur</label>
                        <input pInputText type="text" id="tn" placeholder="Doe" formControlName="nom_tuteur" />
                    </div>

                    <div class="field col-12">
                        <label For="tp">Prénom du tuteur</label>
                        <input pInputText type="text" id="tp" placeholder="John" formControlName="prenom_tuteur" />
                    </div>

                    <div class="field col-12">
                        <label For="tiph">Indicatif télephone du tuteur</label>
                        <input pInputText type="text" id="tiph" placeholder="+33" formControlName="indicatif_tuteur" />
                    </div>

                    <div class="field col-12">
                        <label For="tph">Télephone du tuteur</label>
                        <input pInputText type="text" id="tph" placeholder="0612121214"
                            formControlName="phone_tuteur" />
                    </div>

                    <div class="field col-12">
                        <label For="te">Email du tuteur</label>
                        <input pInputText type="email" id="te" placeholder="email@xxx.com"
                            formControlName="email_tuteur" />
                    </div>

                    <div class="field col-12">
                        <label For="erl">Adresse du tuteur</label>
                        <textarea pInputTextarea placeholder="15 Rue du louvre 75001 Paris, France"
                            formControlName="adresse_tuteur" autoResize rows="3" cols="30"></textarea>
                    </div>
                </div>

                <div class="field col-12">
                    <label>Est une Personne à Mobilité Réduite ?</label>
                    <p-selectButton [options]="[{label:'Oui',value:true},{label:'Non',value:false}]"
                        formControlName="isHandicaped"></p-selectButton>
                </div>

                <div class="field col-12"
                    *ngIf="formAddEtudiant.value.isHandicaped==true || formAddEtudiant.value.isHandicaped.value==true">
                    <label>Avez-vous besoin d'un suivi particulier ?</label>
                    <input pInputText type="text" placeholder="Ascenseur" formControlName="suivi_handicaped" />
                </div>

                <div>
                    <button pButton label="Ajouter l'étudiant" type="submit"
                        [disabled]="formAddEtudiant.invalid"></button>
                </div>
            </form>
        </div>
    </div>
</div>